{"filter":false,"title":"new.php","tooltip":"/new.php","undoManager":{"mark":33,"position":33,"stack":[[{"start":{"row":0,"column":0},"end":{"row":19,"column":2},"action":"insert","lines":["<?php","include('config.inc.php');","","$service = Zend_Gdata_Calendar::AUTH_SERVICE_NAME; // 提供Calendar 的服務名稱","$client = Zend_Gdata_ClientLogin::getHttpClient($googleAccount, $googlePassword, $service);","$gdataCal = new Zend_Gdata_Calendar($client);","","//Title 和when 是必要的欄位，這邊做個防呆","if($_POST['title'] != ''&& $_POST['startDate'] != ''&& $_POST['startTime'] != ''&& $_POST['endDate'] != ''&& $_POST['endTime'] != ''){"," $title = $_POST['title'];"," $where = $_POST['where'];"," $content = $_POST['content'];"," $startDate = $_POST['startDate'];"," $startTime = $_POST['startTime'];"," $endDate = $_POST['endDate'];"," $endTime = $_POST['endTime'];","}else{"," die(\"[<a href=\\\"./\\\">back</a>]<hr /><b>Warning</b>: Too few arguments.\");","}","?>"],"id":1}],[{"start":{"row":18,"column":1},"end":{"row":19,"column":0},"action":"insert","lines":["",""],"id":2}],[{"start":{"row":19,"column":0},"end":{"row":20,"column":0},"action":"insert","lines":["",""],"id":3}],[{"start":{"row":20,"column":0},"end":{"row":34,"column":64},"action":"insert","lines":["$calendarURL=\"http://www.google.com/calendar/feeds/\".urlencode($calendarID).\"/private/full\";","","$newEvent = $gdataCal->newEventEntry();","$newEvent->title = $gdataCal->newTitle($title);","$newEvent->where = array($gdataCal->newWhere($where));","$newEvent->content = $gdataCal->newContent($content);","","$when = $gdataCal->newWhen();","$when->startTime = \"{$startDate}T{$startTime}:00.000+08:00\";","$when->endTime = \"{$endDate}T{$endTime}:00.000+08:00\";","$newEvent->when = array($when);","","//當上傳事件後，Google 會回傳相同的事件，我們就可以得知這個事件的ID 了","//這裡值得注意的是第二個參數，指定上傳到我第二本日曆","$createdEvent = $gdataCal->insertEvent($newEvent, $calendarURL);"],"id":4}],[{"start":{"row":34,"column":64},"end":{"row":35,"column":0},"action":"insert","lines":["",""],"id":5}],[{"start":{"row":35,"column":0},"end":{"row":36,"column":0},"action":"insert","lines":["",""],"id":6}],[{"start":{"row":36,"column":0},"end":{"row":37,"column":0},"action":"insert","lines":["",""],"id":17}],[{"start":{"row":37,"column":0},"end":{"row":38,"column":0},"action":"insert","lines":["",""],"id":18}],[{"start":{"row":38,"column":0},"end":{"row":39,"column":0},"action":"insert","lines":["",""],"id":19}],[{"start":{"row":39,"column":0},"end":{"row":40,"column":0},"action":"insert","lines":["",""],"id":20}],[{"start":{"row":40,"column":0},"end":{"row":41,"column":0},"action":"insert","lines":["",""],"id":21}],[{"start":{"row":41,"column":0},"end":{"row":56,"column":27},"action":"insert","lines":["//到這裡已經完成事件的建立了，接著騷包一點讓他來個簡訊提醒吧","//目前網路上的範例提醒不能用，因為他把reminders 打成reminder 了","$query = $gdataCal->newEventQuery();","$query->setUser($calendarID);","$query->setVisibility('private');","$query->setProjection('full');","$query->setEvent($createdEvent->id->text);","$event = $gdataCal->getCalendarEventEntry($query);","$times = $event->when;","foreach ($times as $when) {"," $reminder = $gdataCal->newReminder();"," $reminder->setMinutes(5); //五分鐘前提醒我"," $reminder->setMethod('sms'); //用簡訊"," $when->reminders = array($reminder);","}","$eventNew = $event->save();"],"id":22}],[{"start":{"row":41,"column":0},"end":{"row":56,"column":27},"action":"remove","lines":["//到這裡已經完成事件的建立了，接著騷包一點讓他來個簡訊提醒吧","//目前網路上的範例提醒不能用，因為他把reminders 打成reminder 了","$query = $gdataCal->newEventQuery();","$query->setUser($calendarID);","$query->setVisibility('private');","$query->setProjection('full');","$query->setEvent($createdEvent->id->text);","$event = $gdataCal->getCalendarEventEntry($query);","$times = $event->when;","foreach ($times as $when) {"," $reminder = $gdataCal->newReminder();"," $reminder->setMinutes(5); //五分鐘前提醒我"," $reminder->setMethod('sms'); //用簡訊"," $when->reminders = array($reminder);","}","$eventNew = $event->save();"],"id":23},{"start":{"row":41,"column":0},"end":{"row":55,"column":64},"action":"insert","lines":["$calendarURL=\"http://www.google.com/calendar/feeds/\".urlencode($calendarID).\"/private/full\";","","$newEvent = $gdataCal->newEventEntry();","$newEvent->title = $gdataCal->newTitle($title);","$newEvent->where = array($gdataCal->newWhere($where));","$newEvent->content = $gdataCal->newContent($content);","","$when = $gdataCal->newWhen();","$when->startTime = \"{$startDate}T{$startTime}:00.000+08:00\";","$when->endTime = \"{$endDate}T{$endTime}:00.000+08:00\";","$newEvent->when = array($when);","","//當上傳事件後，Google 會回傳相同的事件，我們就可以得知這個事件的ID 了","//這裡值得注意的是第二個參數，指定上傳到我第二本日曆","$createdEvent = $gdataCal->insertEvent($newEvent, $calendarURL);"]}],[{"start":{"row":55,"column":64},"end":{"row":56,"column":0},"action":"insert","lines":["",""],"id":24}],[{"start":{"row":56,"column":0},"end":{"row":57,"column":0},"action":"insert","lines":["",""],"id":25}],[{"start":{"row":57,"column":0},"end":{"row":58,"column":0},"action":"insert","lines":["",""],"id":26}],[{"start":{"row":58,"column":0},"end":{"row":59,"column":0},"action":"insert","lines":["",""],"id":27}],[{"start":{"row":59,"column":0},"end":{"row":60,"column":0},"action":"insert","lines":["",""],"id":28}],[{"start":{"row":60,"column":0},"end":{"row":61,"column":0},"action":"insert","lines":["",""],"id":29}],[{"start":{"row":61,"column":0},"end":{"row":62,"column":0},"action":"insert","lines":["",""],"id":30}],[{"start":{"row":62,"column":0},"end":{"row":63,"column":0},"action":"insert","lines":["",""],"id":31}],[{"start":{"row":63,"column":0},"end":{"row":79,"column":0},"action":"insert","lines":["//到這裡已經完成事件的建立了，接著騷包一點讓他來個簡訊提醒吧","//目前網路上的範例提醒不能用，因為他把reminders 打成reminder 了","$query = $gdataCal->newEventQuery();","$query->setUser($calendarID);","$query->setVisibility('private');","$query->setProjection('full');","$query->setEvent($createdEvent->id->text);","$event = $gdataCal->getCalendarEventEntry($query);","$times = $event->when;","foreach ($times as $when) {"," $reminder = $gdataCal->newReminder();"," $reminder->setMinutes(5); //五分鐘前提醒我"," $reminder->setMethod('sms'); //用簡訊"," $when->reminders = array($reminder);","}","$eventNew = $event->save();",""],"id":32}],[{"start":{"row":79,"column":0},"end":{"row":80,"column":0},"action":"insert","lines":["",""],"id":33}],[{"start":{"row":80,"column":0},"end":{"row":81,"column":0},"action":"insert","lines":["",""],"id":34}],[{"start":{"row":81,"column":0},"end":{"row":82,"column":0},"action":"insert","lines":["",""],"id":35}],[{"start":{"row":82,"column":0},"end":{"row":83,"column":0},"action":"insert","lines":["",""],"id":36}],[{"start":{"row":83,"column":0},"end":{"row":84,"column":0},"action":"insert","lines":["",""],"id":37}],[{"start":{"row":1,"column":9},"end":{"row":1,"column":10},"action":"insert","lines":["g"],"id":38}],[{"start":{"row":1,"column":10},"end":{"row":1,"column":11},"action":"insert","lines":["o"],"id":39}],[{"start":{"row":1,"column":11},"end":{"row":1,"column":12},"action":"insert","lines":["o"],"id":40}],[{"start":{"row":1,"column":12},"end":{"row":1,"column":13},"action":"insert","lines":["g"],"id":41}],[{"start":{"row":1,"column":13},"end":{"row":1,"column":14},"action":"insert","lines":["l"],"id":42}],[{"start":{"row":1,"column":14},"end":{"row":1,"column":15},"action":"insert","lines":["e"],"id":43}],[{"start":{"row":1,"column":15},"end":{"row":1,"column":16},"action":"insert","lines":["/"],"id":44}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":23,"column":37},"end":{"row":23,"column":37},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1471086646222,"hash":"57edd957f7804ee07f55c29ab8ad33ca861f513d"}